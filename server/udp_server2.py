import socket
import time

### state of leds:
# False = OFF
# True = ON
prec4 = False       # prec state of led 4
prec5 = False       # prec state of led 5
prec4_mem = False   # prec memory of led 4
prec5_mem = False   # prec memory of led 5
###

### pins declaration
btn_arr = [12, 14]  # array of possible buttons
led4 = 4
led5 = 5
led_onboard = 2
###

### state of onboard led (pin 2):
# False = ON
# True = OFF
prec2 = True
###

### "operative system" state
state = "home"
###

### variables to handle double button click
start = time.time() # now
DELTA_BTN = 1 # = 1s // time between two btn clicks
###

### UDP variables ###
LOCAL_IP = '0.0.0.0'   # IP of local server
ESP_IP = '192.168.1.22'     # IP of ESP
PORT = 65432                # Port to listen on (non-privileged ports are > 1023)
BUFFER_SIZE = 1024          # Normally 1024
### ###


scatman = bytearray(b'*\x8a\xfb\xfa\xaf\xab\xff\xd4\xaf\xff\xfe\xaa\xbfj%%\x90\xa1\x7f\xfe\xaa\xbf\xff\xea\x17\xf7\xffU_\xf5$\x94J\x14\xbf\xf5W\xff\xca\xe9*U\xb7\xaa\xbd\x94\x92\xaa\xa9B\xaf\xfa\xaa\xff\xea)\x15J\xab\xd2_\xd2H\x92\x04\x11W\xf5U\xea\x92\xa8\x08%TI^\x94\x92J\xa5D\x13\xfa\xab\xea\x92\n\n\x90+$\xadRI*H!k\xf5T\xaaI)$J\x94\x92\xbe\x94\x92\xa5J\x88)\xfdJ\xaaI$\x12HJ\x10\x8e\x92H\x94@R\xa7\xf5$\xaa\xa4H\x08%!\x05~\xa8\x92J)\x10Q\xfd\x92\x11\x12\n\xa5\x00\x00\x01.\x88\x89R\x84\x01*\xf5D\xa4\xa4$\x10\x88\x00\x02\xdaR$*\xa4A*\xfdR$\x10\x12\n\x00\x00\x08Z\x89\x12\x92\x10\x00\xa5\xfbD@\x80H\xa4@\x00\x05\xb5$$IJ\x80(]R \x00*\x12@\x00\x00\xb4\x91%TP\x00\xa5\xbe\xa4\x00\x00\x94\x8a\x80\x01Uu$H\x12\x12\x00\x10_U@\x00\x92\x02@\x00\x02\xa9\x14\x05J\xa4\x00\xa9^\xa0\x00\x00T)\x00\x02)t@\x10\x92$\x00\x14\xaf\xaa\x00\x01\x12\x85@\x01\x05jT\nJH\x00I^\xa4\x88\x00\xd4I \nR\xe9 \x11% \x00$O\xd4\xa0\x00$"\x90\x81\x15iT\t$H\x00\n_U\x10\x12\xa9\t@$\xa5\xe9\x10"JH\x00\x05\'\xd5D\x02\xa4\x8a\xaa\x90\x12\xea\x90\t"\x00\x00\x02\xaf\xa8"\x89RUP\n\xabj \x92U@\x00\x02\x97\xd5\xa8%Z\x92\xaa\xa0I\xe9 A\x14 \x00\x01o\xd4J\x95\xea\xad\xe9\x15+R@*B\x80\x00\tS\xd5P\x95\xfe\xaf\xf4\x92\xa5\xd2A\x01* \x00\x02\xaf\xea\xaaK\xff\xff\xd5IV\xa1\x00\x94\x92\x80\x00\x00C\xea\xaa\xa9\xff\xff\xd5$J\xe8\x80\x04\x92\x00\x00\x02\x97\xea\xa9W\xff\xff\xaa\x92\xafQ\x00\x02%\x90\x00\x00\x91\xf5TP\xbf\xff\xa9J"\xc8\x80\x08\x94\x00\x00\x01\'\xea\xaa\xaf\x7f\xff\xd5)^\xa2\x00\x05"@\x00\x01\x15\xfa\xaa\xa9\xff\xbf\xea\xa4\xa5\xea\x00!*\x00\x00\x00I\xea\xa9W\xff\xff\xf5U]\xa8\x00\x08\x81\x80\x00\x00,uU[\xff\xff\xfdUV\x88\x00\x08T\x00\x00\x00\x01\xda\xaa\xbf\xff\xff\xfe\xaa\xab\x80\x00\x05\x12\x80\x00\x00\x00z\xaa\xbf\xff\xff\xff\xaa\xb5\x80\x00\x00J\x00\x00\x00\x00\xda\xab\xff\xff\xff\xff\xea\xaa\x80\x00\x01!\x80\x00\x00\x00n\xab\xff\xff\xff\xff\xea\xb5\x80\x00\t\x14\x00\x00\x00\x00Z\xaf\xff\xff\xff\xff\xf5W\x00\x00\x02E\x00\x00\x00\x00n\xa7\xff\xff\xff\xff\xfa\xe9\x80\x00\x08P\x00\x00\x00\x00z\xaf\xff\xff\xff\xff\xfa\xab\x00\x00\x12\x8a\x80\x00\x00\x00-W\xff\xff\xff\xff\xfe\xd5\x00\x00\x10"\x00\x00\x00\x00=\xaf\xff\xff\xff\xff\xfd\xab\x00\x00\x05I\x80\x00\x00\x00>\xd7\xff\xff\xff\xff\xfd\xd5\x00\x00\x00$\x00\x00\x00\x00\x1d\xaf\xff\xf5W\xff\xffV\x00\x00\x02\x92\x80\x00\x00\x00\x1e\xd7\xfe\xaa\xa8\xbf\xffV\x00\x00\x00\x92\x00\x00\x00\x00\x1d\xaa\xed\xaa\xabU\xf5\xac\x00\x00\x02$\x80\x00\x00\x00\x0e\xea\xb6\xaa\xa9U+T\x00\x00\x01\x12\x00\x00\x00\x00\x0fj\xabUV\xaa\xd6\xac\x00\x00\x00\xa4\x80\x00\x00\x00\x07z\xaa\xea\xaa\xaaV\xa8\x00\x00\x08\x12\x00\x00\x00\x00\x0f\xba\xaa\xb5V\xaa\xadX\x00\x00\x00\x89\x80\x00\x00\x00\x07\xbe\xaa\xb6\xaa\xaa\xbfP\x00\x00\x00\x04\x00\x00\x00\x00\x0f]UUUUT\xa0\x00\x00\x00R\x00\x00\x00\x00\x0f\xafUUUUwp\x00\x00\x00\x12\x00\x00\x00\x00\x0f\xde\xaa\xda\xb6\xaa\xa9d\x00\x00\x01\t\x00\x00\x00\x00\x07\xef\xea\xaa\xabUmt\x00\x00\x00\x08\x00\x00\x00\x00\x0f\xd6\xaa\xaa\xaa\xaa\xb5\xfa\x00\x00\x00E\x00\x00\x00\x00\x07\xf6\xd5UUUV\xff@\x00\x00P\x00\x00\x00\x00\x0f\xebj\xaa\xaa\xabm\xff\x10\x00\x00\n\x80\x00\x00\x00\x0f\xff\xd5UUUo\xff\xd4\x00\x04\x82\x00\x00\x00\x00?\xff\xaa\xaa\xaa\xab\x7f\xff\xf0\x80\x00T\x00\x00\x00\x00/\xff\xf5UUU\xff\xff\xfc\x80\x15\x02\x00\x00\x00\x00\x7f\xff\xd5\xb5UW\xff\xff\xfd!@T\x80\x00\x00\x00\xef\xff\xfa\xddV\xab\xff\xdf\xff\x90\x15\x02')

other = bytearray(b'\x00\x00\x00\x00\x7f_\xff\xff\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x7f\x81\xff\xbf\xfe\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x07\xfd_\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00Z\x03\xfe\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xfc\x00 \x05\xfe\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x01\xfe\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xfc\x00\x00\x01~\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xfd\x00\x00\x01\xfe\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xfa\x00\x00\x01\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xfd\x00\x00\x00\x7f\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xf8\x00\x00\x00\xff\xc0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\xfd\x00\x00\x00\x7f\xc0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xf9\x00\x00\x00\xff\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\xfc\xe8\x00\x10\x7f\xc0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xf3>\x01n\x7f\x00\x00\x00\x18\x00\x00\x00\x00\x00\x00\x03\xfa\x83\x85S\x7f\x80\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x07\xf2P@\x88\x7f\x80\x02\x00|\x00\x00\x00\x00\x00\x00\x03\xf8X@\x15?\xc0\x00\x11\xae\xa0\x80\x00\x00\x00\x00\x01\xf0\x80\x00$\x7f\x80\x00"\xd7U\x00\x00\x00\x00\x00\x00\x14\x00\x00\x04?\x80\x00Ou\xd5\xc0\x00\x00\x00\x00\x00(\x00\x00\x00\x7f\x00\x02\xfe\xda\xbe\x80\x00\x00\x00\x00\x00*\x00\x00\x00?\x00\x00\xbe\xea\xd2\xc0\x00\x00\x00\x00\x00\x14\x00@\x00\xa0\x00\x03\xfbZ\xad@\x00\x00\x00\x00\x00\x15\x00@\x00\x10\xe8\x07\xfe\xff\xaa\xa0\x00\x00\x00\x00\x00\n\x00\x80\x00\x80|?\xfb\xff\xfd@\x00\x00\x00\x00\x00\t\x00@\x00\x00Xo\xff\xff\xfdp\x00\x00\x00\x00\x00:A%\x01\x00\xba?\xff\xfe\xfe\x90\x00\x00\x00\x00\x00=\x00\x10\x00\x80 ?\xff\xdd\xdfP\x00\x00\x00\x00\x00x\x00\x00\x01@\x00\xfe\xff\xa5\x7fP\x00\x00\x00\x00\x00~\x00\x00\x00\xf0\x01\xff\xff@\xb7\xa8\x00\x00\x00\x00\x00\xfc\x00\x00\x01\xf0\x07\xfb\xff\xf0]\xa8\x00\x00\x00\x00\x00\xff\x00\xab\x00\xf8\x06\xff\xfc8\r\xa8\x00\x00\x00\x00\x01\xff\x01\x00\x01\xf8=\xff\xf5\x00m\xd4\x00\x00\x00\x00\x01\xff\x80\x00\x01\xf8?\xff\xfa\xa0U\xd4\x00\x00\x00\x00\x03\xff\xc0\x00\x01\xf8\xfb\xff\xc5\x88+\xe8\x00\x00\x00\x00\x03\xff\xe0\x00\x00\xfc\xdd\xff\xe4%\x05\xec\x00\x00\x00\x00\x07\xff\xe0\x00\t\x9c\xb7\xff\x90\x1aC\xf4\x00\x00\x00\x00\x07\xff\xe0\x00\x00\x8c\xd7\xff\xd4J1\xfa\x00\x00\x00\x00\x0f\xff\x80\x00Q\x04\xb7\xff\xa0"\x95\xfa\x00\x00\x00\x00\x0f\xff\x80\x00@\x02W\xff\xa8\x12\x08\xfa\x00\x00\x00\x00\x1f\xff\x00~\x80\x06?\xff\xa0b\x03\xfc\x00\x00\x00\x00\x0f\xff\x00\x00\x00\x06\x07\xff\xa8\x1a\x00\xfe\x00\x00\x00\x00\x0f\xff\x00\x00\x00\x03\x01\xffP\xc0\n\xfa\x00\x00\x00\x00\x1f\xff\x80\x00\x00\x03\x01\xff\xaaR\x02\xfd\x00\x00\x00\x00\x7f\xff\x80\x00\x00\x03\x03\xffR\x94\x0b\xf6\x00\x00\x00\x01\xff\xff\x80\x00\x00\x03\xff\xfb\xaaR\x01\xfb\x00\x00\x00\x03\xff\xff\x80\x00\x00\x01\xff\xfb\xa1\xaa/\xfa\x80\x00\x00\x0f\xff\xff\xc0\x00\x00\x01\xff\xff\xd5Y\x03\xfa\x80\x00\x00?\xff\xff\xe0\x00\x00\x01\xff\xff\xaa\x94W\xfa\x80\x00\x00?\xff\xff\xf8\x00\x00\x01\xff\xff\xeaE\x0b\xfd@\x00\x01\xff\xff\xff\xf8\x00\x00\x00\xff\xff\xa9Ro\xf5@\x00\x03\xff\xff\xff\xfe\x00\x00\x00\xff\xff\xf5\t\x17\xfe\x80\x00?\xff\xff\xff\xfe\x00\x00\x01\xff\xff\xeaUo\xf3@\x00\x7f\xff\xff\xff\xff\x80\x00\x03\xff\xff\xfa\x15?\xfd\x00\x00\xff\xff\xff\xff\xff\x80\x00\x03\xff\xfb\xfa\x95\x7f\xea\x00\x00\xff\xff\xff\xff\xff\xe0\x00\x03\xff\xfd\xfe\xaa\xff\xee\x00\x01\xff\xff\xff\xff\xff\xf0\x00\x01\xff\xfd\x7f\xad\xbf\xf0\x00\x01\xff\xff\xff\xff\xff\xf8\x00\x01\xff\xfd\xb7\xff\x7f\xc0\x00\x01\xff\xff\xff\xff\xff\xfe\x00\x00\xff\xffU\xfd\x7f\x80\x00\x01\xff\xff\xff\xff\xff\xfe\x00\x00\xff\xfe\xd4\x8a\xbc\xc0\x00\x01\xff\xff\xff\xff\xff\xf8\x00\x01\xff\xffj\xb4\xfd\x80\x00\x00\xff\xff\xff\xff\xff\xfe\x00\x00\xff\xfft*\xbc\xc0\x00\x01\xff\xff\xff\xff\xff\xfc\x00\x01\xff\xff\xd5U~\x80\x00\x00\xff\xff\xff\xff\xff\xff\xc0\x01\xff\xff\xaa\xab\x7f\xe0\x00')

scatman2 = bytearray(b'H"\xf7\xfdV\xd7\xff\xf2/\xf7~\xaa\xbfj$\x95\xa5)\x7f\xfa\xab\x7f\xed\xd9\x0b\xbb\xff\xaa\x9f\xf5\x92TRB\xaf\xfa\xad\xff\xd5d*E\xab\xa5}\x94I%\x89(\xb7\xfdU\xfe\xa95\nR\xd5\xa9\x1f\xd5$\x92RBO\xf5W\xe2\x84\x88$\x88*R\xad!J\xaaR)!\xfdR\xb5R*$\xa5UH\xad\x94 J\x08\x80\xad\xf5-U)\x14\x08H*"\xaeR\x95%\xa4\x88"\xfdAT\x89\x12\nJ\x92\x00\xae\x8aD\x94I![\xfa\xaaJ\xa4H\x10 A\x02\xbfP\x92RI\x10I\xfdBR\x12\n\x8a\x00\x00\x00N\x88\x89J"\x01*\xfa\xa9\t@$$\x80\x00\x02\xba\x92$%\x92@\x92\xfe\xa1H(\x15\x12\x00\x00\tZI%TH\x00U{T \x00H\x89@\x00\x04\xb5*\x10%"\x80)_Q\x00\x00J\x8a@\x00\x02\xb5\x11J\x94\x94\x00\x92\xbe\xa4\x00\x00\xa4$\x80\x01Ur\x14\x11%B\x00\tOR@\x00U\x02@\x00\x00\xba\x84\x04\xa4(\x00\x92\xbe\xa9\x00\x00\xa2*\x80\x02*\xf4 \x12\x12\x84\x00\x08\x8fT\x90\x00*\x84\xa0\x02\x89:\x94\tJ \x00H\x7f\xaa@\x01PJ\x80\x08Ud`\x12R \x00*\x0f\xd5$\x00\xaa\x04\xb4\x80Eu(\t\nH\x00\toR\x82\x15T\n\x89%*\xb1@"\xa5H\x00\x05\x17\xaaQER\xa5i$\xa9Z\x90\x08\x94\x00\x00\x02\xafUJ*\xaaUT\x92%i \x92J@\x00\x00\x97\xd5R\x95z\xabj\x92\xaa\xb5 BR \x00\x05k\xaa\xa9W\xfe\xaf\xeaJ\x92\xc8@)\t\x80\x00\x00\xab\xea\xaaS\xff\xff\xfa\xa9UjA\x08\xa4 \x00\x05K\xaa\xa9U\xff\xff\xe5J\xa5Q\x00\x92R\x80\x00\x00+\xea\xaa\xab\xff\xff\xea\xa4\x92\xa8\x80\x81\n\x00\x00\x02E\xaa\xaa\xab\xff\xff\xb5R\xaa\xc1\x00\x04\xa2\x90\x00\x02U\xea\xaa\xaa\xff\xff\xf5U%t\x80\x04*\x00\x00\x00\x8b\xaa\xaa\xaf\xff\xff\xea\xaa\x95I\x00\x02\x92@\x00\x00\xa5\xea\xaa\xab\xff\xff\xfe\xa9U\xd5\x00 \x92\x00\x00\x00)\xb5U\xbf\xff\xff\xfdU*\xd0\x00\nI\x80\x00\x00,\xaa\xaa\xff\xff\xff\xff\xea\xaa\xc0\x00"$\x00\x00\x00\x00\xf5U\xff\xff\xff\xff\xda\xaf\x80\x00\x04\x92\x80\x00\x00\x00\xb5W\xff\xff\xff\xff\xfdR\xc0\x00\x00\x8a\x00\x00\x00\x00\xda\xaf\xff\xff\xff\xff\xfa\xae\x80\x00\x02Q\x80\x00\x00\x00mW\xff\xff\xff\xff\xfe\xaa\xc0\x00\x02\x14\x00\x00\x00\x00z\xaf\xff\xff\xff\xff\xfdW\x80\x00\x00B\x00\x00\x00\x00-\xaf\xff\xff\xff\xff\xfe\xb5\x80\x00\t*\x00\x00\x00\x00z\xaf\xff\xff\xff\xff\xfe\xab\x00\x00\x12A\x80\x00\x00\x00=\xaf\xff\xff\xff\xff\xffU\x80\x00\x12T\x00\x00\x00\x00=_\xff\xff\xff\xff\xfe\xab\x00\x00\x04\x89\x80\x00\x00\x00\x1f\xaf\xff\xff\xff\xff\xffk\x00\x00\x04$\x00\x00\x00\x00\x1d\xd7\xff\xff\xff\xff\xffV\x00\x00\x02\x92\x80\x00\x00\x00\x1e\xd7\xff\xff\xff\xff\xfe\xd7\x00\x00\x00\x92\x00\x00\x00\x00\x1d\xd5\xff\xff\xff\xfd]n\x00\x00\x02$\x80\x00\x00\x00\x0fj\xab\xff\xff\xf6\xa5f\x00\x00\x01\x12\x00\x00\x00\x00\x0e\xf5Z\xff\xff\xd5Z\xdc\x00\x00\x00\xa4\x80\x00\x00\x00\x0fuU_\xffUJ\xc4\x00\x00\x08\x12\x00\x00\x00\x00\x0fz\xaa\xa4\x08\xaa\xabX\x00\x00\x00\x89\x80\x00\x00\x00\x0f\xba\xaa\xab\xd6\xaa\xab\xa8\x00\x00\x00\x04\x00\x00\x00\x00\x0f\xbdUT)UV\xa8\x00\x00\x00R\x00\x00\x00\x00\x0f\xde\xaa\xabUUV\xa8\x00\x00\x00\x12\x00\x00\x00\x00\x0f\xadV\xd4\xaa\xaa\xabP\x00\x00\x01\t\x00\x00\x00\x00\x0f\xee\xabv\xb5\xb5Z\xbc\x00\x00\x00\x08\x00\x00\x00\x00\x0f\xd7U\xfd\xda\xd5U}\x00\x00\x00E\x00\x00\x00\x00\x07\xf7U_oj\xad\x7f@\x00\x00P\x00\x00\x00\x00\x0f\xd7\xaa\xd5Z\xaa\xb6\xff\x80\x00\x00\n\x80\x00\x00\x00\x0f\xfb\xaa\xb5\xad\xd5Z\xff\xf4\x00\x04\xa2\x00\x00\x00\x007\xf7\xd5UUUw\xff\xf2\x80\x00\x14\x00\x00\x00\x00?\xfb\xd5UUU]\xff\xfc\x80\x14\x82\x00\x00\x00\x00o\xff\xb5UUU\x7f\xff\xfeABT\x80\x00\x00\x01\xef\xff\xd5UUU\x7f\xff\xff\xa8Q\x02')

scatman3 = bytearray(b'T\x85u\xfa\xb6\xbf\xfb\xea+g\xffU_\xea\x94\x95\x92Q\x7f\xfa\xaa\xff\xeai\x151\xd7\xaa\xae\xeaBTI\n\xaf\xfa\xab\xffUT*\x8e\xab\xa5_\x95)%\xa4\xa1W\xfdU\xf5R\x95\x04\xa2UT\xaf\xa8\x84\x92R\x08\xab\xf5W\xea\x88(()UI]RR\xaa\x92\xa4)\xfa\xa8*\xa5\n\n\x84*$\xae\x89\x08JH\x01U\xfa\x97T\x10\xa8\x10R\x91B^\xaaU%J\x88\x14\xfd@\xaa\xaa%\x15\x08T\x02\xae\x89\x04\x94@QS\xf6\xaa$\x80\x14\x08\x04\x01\x04\xbe\xa4\xa9J)\x10(\xfa\xa1$\xaa\x12\xa5\x00\x00\x01N\x92\x04R\x84\x01W\xfdJI\x10H\x12\x00\x00\x02\xbaH\xaa\x95R@\x10\xfe\xa1 \x10%\n\x80\x00\t]*\x00\xa4\x08\x00\xaa\xfdTH\x00H\xa4@\x00\x04\xb2\x11*\x12\xa2\x80\x92^\xa2@\x00*\x12@\x00\x02\xb5\t\x01J\x14\x00)_T\x00\x00\x92\x8a\x80\x01Uj\x10\xaaRB\x00\x08\xafR@\x00T\x02@\x00\x02\xba\x94\x02\x8a\x88\x00\x15^\xa9\x00\x00\xa2) \x02\xa9R \x14R\xa4\x00HOUP\x02Z\x8a\xa0\x00\n\xb5\x14\x02J\x08\x00\x14\xbd\xa8\x88\x01@%(*\xa5XH\x14\x92\xa0\x00\x04\x8fVH\x02\xaa$\x94\x81)UH\x04\x92\x10\x00\nm\xa9R*\xa9\x12\xa9*J\xb2\x90"JH\x00\x05.\xd5I%UJ\xac\x81%Z\x90\x12R\x00\x00\x02\x97U$Uj\xab\xaaT\x92\xb5 \x89\t@\x00\x01WUU\x15\xfe\xab\xf5J\xaa\xa9 IT \x00\x04\xae\xaa\xaa\xab\xff\xbf\xf5%Ed@\x12\n\x80\x00\x04S\xa5T\xab\xff\xff\xfa\xa9R\xb2A\x02\xa2 \x00\x00\xae\xaa\xaa\xab\xff\xff\xea\x95*\xe9\x00\x90\x95\x80\x00\x02C\xaa\xb5U\xff\xff\xd5R\x89(\x80\x84\x90\x00\x00\x01+UUU\xff\xff\xea\xaa\xa5a\x00\x02J\x80\x00\x01\x0b\xaaUU\xff\xff\xfdT\x95i\x00\x02J\x00\x00\x00\xa5\xd5U_\xff\xff\xfa\xaaJ\xd2\x00\x04\x92@\x00\x00\x8b\xeaUW\xff\xff\xffR\xaa\xea\x00 \x92\x00\x00\x00W\xaa\xaa\xff\xff\xff\xfe\xaa\x95P\x00\nI\x80\x00\x00(\xea\xaa\xbf\xff\xff\xff\xd5U\xc0\x00"$\x00\x00\x00\x01\xd5U\xff\xff\xff\xff\xaa\xaa\xc0\x00\x04\x92\x80\x00\x00\x00z\xaa\xff\xff\xff\xff\xe9V\xc0\x00\x00\x8a\x00\x00\x00\x00\xd5U\xff\xff\xff\xff\xf5U\xc0\x00\x02Q\x80\x00\x00\x00Z\xab\xff\xff\xff\xff\xf5V\xc0\x00\x02\x14\x00\x00\x00\x00uW\xff\xff\xff\xff\xfa\xab\x80\x00\x00B\x00\x00\x00\x00>\xab\xff\xff\xff\xff\xfa\xad\x80\x00\t*\x00\x00\x00\x00j\xaf\xff\xff\xff\xff\xfdk\x80\x00\x12A\x80\x00\x00\x00>\xd7\xff\xff\xff\xff\xfe\xad\x80\x00\x12T\x00\x00\x00\x00:\xaf\xff\xff\xff\xff\xfdk\x00\x00\x04\x89\x80\x00\x00\x00\x1e\xd7\xff\xff\xff\xff\xfe\xab\x00\x00\x04$\x00\x00\x00\x00\x1bo\xff\xff\xff\xff\xfe\xd6\x00\x00\x02\x92\x80\x00\x00\x00\x0fW\xff\xff\xff\xff\xffW\x00\x00\x00\x92\x00\x00\x00\x00\x1e\xeb\xff\xff\xff\xff\xfe\xd6\x00\x00\x02$\x80\x00\x00\x00\x0fk\xff\xff\xfa\xff\xffV\x00\x00\x01\x12\x00\x00\x00\x00\x06\xea\xaf\xf5Kz\xbdT\x00\x00\x00\xa4\x80\x00\x00\x00\x07\xb5k\xf5j\xba\xaa\xec\x00\x00\x08\x12\x00\x00\x00\x00\x0fuT\xda\x95\xca\xaa\x90\x00\x00\x00\x89\x80\x00\x00\x00\x07\xbdV\xaa\xd5UU\xd8\x00\x00\x00\x04\x00\x00\x00\x00\x0fuU]VUUP\x00\x00\x00R\x00\x00\x00\x00\x07\x9dUB\xa9\x15U\xa8\x00\x00\x00\x12\x00\x00\x00\x00\x07\xea\xaa\x95\x04\xaa\xabP\x00\x00\x01\t\x00\x00\x00\x00\x07\xdfUQU*\xab\\\x00\x00\x00\x08\x00\x00\x00\x00\x07\xda\xaa\xaa\xaa\xaa\xaa\xbd\x00\x00\x00E\x00\x00\x00\x00\x07\xee\xadUUUV\xbf\xc0\x00\x00P\x00\x00\x00\x00\x0f\xdd\xb6\xaa\xaaV\xad\x7f\xa0\x00\x00\n\x80\x00\x00\x00\x0f\xedV\xa4\x92\xabV\xbf\xf8\x00\x04\xa2\x00\x00\x00\x00?\xf7oZ\xa9]U\x7f\xf4\x80\x00\x14\x00\x00\x00\x007\xf7\xab\xd5Un\xae\xff\xfe\x80\x14\x82\x00\x00\x00\x00o\xfe\xaf\xfa\xad\xba\xbf\xff\xfeQBT\x80\x00\x00\x00\xf7\xff\xd5\xff\xff\xfdM\xff\xff\xd4Q\x02')

replrebl = bytearray(b'\xff\xff\xff\xff\x00\x03\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x7f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00?\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x008\x00\x18\x03\xfc\x0f\xff\xff\xff\xff\xff\xff\xff\xff\xe0\x00\x18\x00\x18\x00|\x0f\xff\xff\xff\xff\xff\xff\xff\xff\x80\x00\x18\x00\x10\x00<\x0f\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x00\x10\x00\x10\x00\x1c\x0f\xff\xff\xff\xff\xff\xff\xff\xfe\x01\xc0\x10\x00\x10\x00\x18\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x01\xe0\x00\x00\x10\x00\x08\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x03\xf0\x00\x000\x00\x08\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x03\xf0\x00?\xf08\x08\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x03\xf0\x00?\xf0<\x08\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x03\xf0\x00?\xe0|\x08\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x03\xe0\x00\x00`|\x08\x1f\xff\xff\xff\xff\xff\xff\xff\xfe\x03\xc0\x00\x00`|\x00?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x00\x00\x00`x\x00?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x00 \x00`\x00\x10?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x00 \x00\xe0\x00\x10?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x00`\x00\xe0\x000?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x00`\x7f\xc0\x000?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x00\xc0\xff\xc0\x00p?\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x03\xc0\xff\xc0\x00\xe0\x7f\xff\xff\xff\xff\xff\xff\xff\xfc\x00\x01\xc0\x00@\x07\xe0\x00\x7f\xff\xff\xff\xff\xff\xff\xfc\x06\x01\xc0\x00@\xff\xe0\x00\x7f\xff\xff\xff\xff\xff\xff\xfc\x07\x00\xc0\x00@\xff\xe0\x00\x7f\xff\xff\xff\xff\xff\xff\xfc\x07\x00\xc0\x00@\xff\xe0\x00\x7f\xff\xff\xff\xff\xff\xff\xf8\x07\x80\xc0\x00\x80\xff\xe0\x00\x7f\xff\xff\xff\xff\xff\xff\xf8\x07\x80\x00\x00\x81\xff\xe0\x00\x7f\xff\xff\xff\xff\xff\xff\xf8\x07\x80\x00\x00\x81\xff\xc0\x00\xff\xff\xff\xff\xff\xff\xff\xf8\x07\xc0?\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xf8\x00\x00\x00\x00\x80\x0f\xc0\xff\xff\xff\xff\xff\xff\xff\xff\xf8\x00\x0f\x80\x00\x80\x03\xc0\xff\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x07\x80\x01\x80\x01\xc0\x9f\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x03\x80\x01\x80\x01\xc0\x8f\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x03\x80\x01\x00\x01\xc0\x83\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x01\x00\x01\x00\x00\x80\x80\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x01\x00\x03\x03\x80\x81\x80?\xff\xff\xff\xff\xff\xff\xfe\x07\x01\x03\xff\x03\xc0\x81\xc0\x1f\xff\xff\xff\xff\xff\xff\xfc\x0f\x81\x03\xff\x07\xc1\x81\xf0\x1f\xff\xff\xff\xff\xff\xff\xfc\x0f\x81\x00\x07\x07\x81\x81\xfc\x1f\xff\xff\xff\xff\xff\xff\xfc\x0f\x81\x00\x07\x00\x01\x81\xf8\x1f\xff\xff\xff\xff\xff\xff\xfc\x0f\x01\x00\x06\x00\x03\x81\xe0\x1f\xff\xff\xff\xff\xff\xff\xfc\x0e\x02\x00\x06\x00\x07\x01\x80\x1f\xff\xff\xff\xff\xff\xff\xfc\x00\x02\x00\x06\x00\x03\x03\x00\x7f\xff\xff\xff\xff\xff\xff\xfc\x00\x02\x00\x06\x00\x03\x02\x01\xff\xff\xff\xff\xff\xff\xff\xf8\x00\x06\x00\x0e\x00\x01\x02\x07\xff\xff\xff\xff\xff\xff\xff\xf8\x00\x0e\x07\xfe\x0f\x81\x02\x1f\xff\xff\xff\xff\xff\xff\xff\xf8\x00\x1e\x07\xfe\x0f\x81\x02\x7f\xff\xff\xff\xff\xff\xff\xff\xf8\x00>\x07\xfe\x0f\x81\x03\xff\xff\xff\xff\xff\xff\xff\xff\xf8\x10\x1c\x00\x04\x0f\x00\x00\x03\xff\xff\xff\xff\xff\xff\xff\xf8\x18\x1c\x00\x04\x00\x02\x00\x07\xff\xff\xff\xff\xff\xff\xff\xf8\x18\x0c\x00\x04\x00\x02\x00\x07\xff\xff\xff\xff\xff\xff\xff\xf0<\x0c\x00\x04\x00\x02\x00\x07\xff\xff\xff\xff\xff\xff\xff\xf0<\x0c\x00\x04\x00\x06\x00\x07\xff\xff\xff\xff\xff\xff\xff\xf0<\x04\x00\x04\x00\x0e\x00\x07\xff\xff\xff\xff\xff\xff\xff\xf0>\x04\x00\x0c\x00~\x00\x07\xff\xff\xff\xff\xff\xff\xff\xff\xfe\x07\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x03\xff\x00\x00\x00\x00\x1f\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x03\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x80\x00\x00\x00\x1f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x80\x00\x00\x7f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xc0\x03\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff')


#### send package cointaining all pins and ####
def send(pkg_arr):
    s.sendto(pkg_arr, (ESP_IP,PORT))  # send UDP message
    
#### ####
    
    
#### MAIN "OPERATIVE SYSTEM" FUNCTION ####
def gaber(btn):
    global prec4, prec5, prec2, led, bit, state, start, prec4_mem, prec5_mem    # view these variables as global
    
    pkg_arr = bytearray() # array to be sent, containing each led new state
    
    ##### BUTTON 12 PRESSED #####
    if btn == 12:
    
        if state == "home":         # home -> led 4 switch state
            print("home, btn 12")
            pkg_arr = scatman
            
        elif state == "app":        # app -> switch both leds
            print("app, btn 12")
            pkg_arr = scatman3
    ##### END BUTTON 12 #####
    
    ##### BUTTON 14 PRESSED #####
    elif btn == 14:
        elapsed = time.time() - start # time elapsed between this click and the previous one
        print(elapsed)
        
        ### double click -> switch between home and app ###
        if elapsed < DELTA_BTN:     
        
            if state == "home":     ## enter the app, switch leds off
                print("home, btn 14, double click")
                state = "app"
                pkg_arr = replrebl
                
            elif state == "app":    ## exit the app, return to previous state
                print("app, btn 14, double click")
                state = "home"
                pkg_arr = scatman
                
        ### end double click ###
        
        ### single click -> routines for home and app ###
        else:                                   
            
            if state == "home":     ## home -> led 5 switch state
                print("home, btn 14")
                pkg_arr = scatman2
            elif state == "app":    ## app -> onboard led (pin 2) switch state
                print("app, btn 14")
                pkg_arr = other
        ### end single click ###
        
        start = time.time() # set start to now, waiting for another double click
    ##### END BUTTON 14 #####
    send(pkg_arr) # send array!
    return 0
    
#### ####
    
## init socket ##
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)    #UDP socket
s.bind((LOCAL_IP,PORT))
## ##

#### loop until data is empty ####
while True:
    data, addr = s.recvfrom(BUFFER_SIZE)
    if not data: break  # exit if data is empty
    print ("received data:", data)
    
    btn = int.from_bytes(data,'big')    # get number of button pressed
    
    if btn in btn_arr:  # if received button is on possible buttons
        gaber(btn) # MAIN
    
#### end loop ####

s.close()   # close socket


